<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Dashboard - ROTA+</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='graficos.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>


    <div class="sidebar">
        <h2>ROTA+</h2>
        <ul>
            <li><a href="/dashboard">Dashboard</a></li>
            <li><a href="#">Alunos</a></li>
            <li class="active"><a href="/veiculos">Veículos</a></li>
            <li><a href="#">Motorista</a></li>
            <li><a href="/rotas">Rotas</a></li>
            <li><a href="/despesas">Despesas</a></li>
            <li><a href="#">Configurações</a></li>
        </ul>
    </div>

    <div class="main">
        <!-- Cards -->
        <div class="cards">
            <div class="card">
                <h3>{{ dados.alunos }}</h3>
                <p>Quantidade de Alunos</p>
            </div>
            <div class="card">
                <h3>{{ dados.novos_alunos }}</h3>
                <p>Novos Alunos</p>
            </div>
            <div class="card">
                <h3>{{ dados.escolas }}</h3>
                <p>Número de Escolas</p>
            </div>
        </div>

        <!-- Gráficos -->
        <div class="charts">
            <div class="chart-box">
                <h3>Frequência Geral</h3>
                <canvas id="graficoLinha"></canvas>
            </div>
            <div class="chart-box">
                <h3>Trânsito de Rotas</h3>
                <canvas id="graficoPizza"></canvas>
            </div>
        </div>

        <!-- Tabela -->
        <h3>Detalhes Gerais</h3>
        <table>
            <thead>
                <tr>
                    <th>Motorista</th>
                    <th>Rota</th>
                    <th>Data</th>
                    <th>Qtd. Passageiros</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>A</td>
                    <td>6065 MaryJane Landing</td>
                    <td>12/08/2019</td>
                    <td>423</td>
                    <td><span class="status finalizado">Finalizado</span></td>
                </tr>
                <tr>
                    <td>B</td>
                    <td>6065 MaryJane Landing</td>
                    <td>12/08/2019</td>
                    <td>423</td>
                    <td><span class="status emrota">Em Rota</span></td>
                </tr>
                <tr>
                    <td>C</td>
                    <td>6065 MaryJane Landing</td>
                    <td>12/08/2019</td>
                    <td>423</td>
                    <td><span class="status pendente">Pendente</span></td>
                </tr>
            </tbody>
        </table>
    </div>

    <script>
        const frequencia = {{ dados.frequencia | safe }};
        const faltas = {{ dados.faltas | safe }};
        const rotas = {{ dados.rotas | safe }};

        new Chart(document.getElementById("graficoLinha"), {
            type: "line",
            data: {
                labels: ["Seg", "Ter", "Qua", "Qui", "Sex"],
                datasets: [
                    { label: "Presenças", data: frequencia, borderColor: "green", fill: false },
                    { label: "Faltas", data: faltas, borderColor: "red", fill: false }
                ]
            }
        });

        new Chart(document.getElementById("graficoPizza"), {
            type: "doughnut",
            data: {
                labels: ["Finalizado", "Em Rota", "Não Iniciado"],
                datasets: [{
                    data: rotas,
                    backgroundColor: ["#4CAF50", "#FFC107", "#F44336"]
                }]
            }
        });
    </script>
</body>
</html>
